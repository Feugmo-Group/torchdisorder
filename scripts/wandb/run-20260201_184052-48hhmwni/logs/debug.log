2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_setup.py:_flush():80] Current SDK version is 0.21.0
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_setup.py:_flush():80] Configure stats pid to 54047
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_setup.py:_flush():80] Loading settings from /Users/conrard/.config/wandb/settings
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_setup.py:_flush():80] Loading settings from /Users/conrard/Downloads/torchdisorder_v5/scripts/wandb/settings
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_setup.py:_flush():80] Loading settings from environment variables
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_init.py:setup_run_log_directory():703] Logging user logs to /Users/conrard/Downloads/torchdisorder_v5/scripts/wandb/run-20260201_184052-48hhmwni/logs/debug.log
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_init.py:setup_run_log_directory():704] Logging internal logs to /Users/conrard/Downloads/torchdisorder_v5/scripts/wandb/run-20260201_184052-48hhmwni/logs/debug-internal.log
2026-02-01 18:40:52,489 INFO    MainThread:54047 [wandb_init.py:init():830] calling init triggers
2026-02-01 18:40:52,490 INFO    MainThread:54047 [wandb_init.py:init():835] wandb.init called with sweep_config: {}
config: {'data': {'root_dir': '/Users/conrard/Downloads/torchdisorder_v5/data', 'data': {'s_of_q_path': '/Users/conrard/Downloads/torchdisorder_v5/data/xrd_measurements/Li3PS4/S_of_Q.csv', 't_of_r_path': None, 'g_of_r_path': None, 'r_max': 20.0, 'n_r_bins': 1000, 'stride_q': 1, 'stride_r': 1}, 'kernel_width': 0.03, 'q_min': 0.5, 'q_max': 40.0, 'neutron_scattering_lengths': {'P': 5.13, 'S': 2.847}, 'number_density': 0.045, 'xray_form_factor_params': {'Li': {'a': [1.1282, 4.7392, 1.8622, 6.291], 'b': [3.954, 0.712, 42.3975, 0.028], 'c': [-9.557]}, 'P': {'a': [6.2915, 4.1791, 1.92, 1.541], 'b': [1.9067, 27.0059, 0.526, 68.1645], 'c': [1.1407]}, 'S': {'a': [6.2915, 5.2915, 1.4386, 1.541], 'b': [1.4679, 22.2151, 0.2536, 56.1725], 'c': [1.473]}}, 'central': 'P', 'neighbour': 'S', 'cutoff': 5.5, 'json_path': '/Users/conrard/Downloads/torchdisorder_v5/data/json/glass_67Li2S_NoLi_constraints.json'}, 'structure': {'root_dir': '/Users/conrard/Downloads/torchdisorder_v5/data', 'init': 'from_cif', 'cif_path': '/Users/conrard/Downloads/torchdisorder_v5/data/crystal-structures/glass_67Li2S_NoLi.cif', 'n_atoms': 5054, 'species': ['P', 'S'], 'stoichiometry': [1200, 3854], 'box_length': 47.5, 'target_density': 1.85, 'constraints_path': '/Users/conrard/Downloads/torchdisorder_v5/data/json/glass_67Li2S_NoLi_constraints.json', 'central_element': 'P', 'central_atomic_number': 15, 'neighbor_elements': ['P', 'S'], 'neighbor_atomic_numbers': [15, 16], 'order_param_cutoff': 3.5, 'order_params': ['tet', 'cn', 'q4'], 'targets': {'tet': {'PS4': 0.85, 'P2S7': 0.6, 'P2S6': 0.65}, 'cn': {'target': 4.0, 'tolerance': 0.5}}}, 'trainer': {'name': 'cooper', 'primal': {'type': 'Adam', 'lr': 0.001, 'betas': [0.9, 0.999]}, 'dual': {'type': 'SGD', 'lr': 0.01, 'maximize': True}, 'lr_reduction': {'enabled': True, 'threshold': 97.5, 'primal_factor': 0.1, 'dual_factor': 0.1}, 'penalty_coefficient': 10.0, 'penalty_schedule': 'constant', 'violation_type': 'soft', 'melt_quench': {'enabled': False, 'trigger_plateau': True, 'plateau_window': 3000, 'melt_temp': 1200, 'quench_temp': 300, 'melt_steps': 2000, 'quench_steps': 5000}}, 'wandb': {'enabled': True, 'project': 'torchdisorder-optimization', 'entity': None, 'tags': ['structure_optimization', 'constrained'], 'notes': ''}, 'accelerator': 'cpu', 'target': 'S_Q', 'max_steps': 5000, 'optimize_cell': False, 'penalty_rho': 10.0, 'lr': {'primal': 0.001, 'dual': 0.01, 'primal_reduced': 0.0001, 'dual_reduced': 0.001}, 'stability': {'grad_clip_norm': 1.0, 'max_displacement': 0.1, 'constraint_warmup_steps': 500}, 'constraints': {'enabled': True, 'use_types': 'all'}, 'order_params': {'backend': 'auto', 'cutoff': 3.5, 'max_neighbors': 64}, 'checkpoint_interval': 200, 'output': {'write_trajectory': True, 'trajectory_path': 'outputs/2026-02-01/18-40-52/trajectory', 'save_plots': True, 'plots_dir': 'outputs/2026-02-01/18-40-52/plots', 'plot_interval': 100}, '_wandb': {}}
2026-02-01 18:40:52,490 INFO    MainThread:54047 [wandb_init.py:init():871] starting backend
2026-02-01 18:40:52,713 INFO    MainThread:54047 [wandb_init.py:init():874] sending inform_init request
2026-02-01 18:40:52,736 INFO    MainThread:54047 [wandb_init.py:init():882] backend started and connected
2026-02-01 18:40:52,740 INFO    MainThread:54047 [wandb_init.py:init():953] updated telemetry
2026-02-01 18:40:52,740 INFO    MainThread:54047 [wandb_init.py:init():977] communicating run to backend with 90.0 second timeout
2026-02-01 18:40:53,339 INFO    MainThread:54047 [wandb_init.py:init():1029] starting run threads in backend
2026-02-01 18:40:53,417 INFO    MainThread:54047 [wandb_run.py:_console_start():2458] atexit reg
2026-02-01 18:40:53,417 INFO    MainThread:54047 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2026-02-01 18:40:53,418 INFO    MainThread:54047 [wandb_run.py:_redirect():2375] Wrapping output streams.
2026-02-01 18:40:53,418 INFO    MainThread:54047 [wandb_run.py:_redirect():2398] Redirects installed.
2026-02-01 18:40:53,419 INFO    MainThread:54047 [wandb_init.py:init():1075] run started, returning control to user process
